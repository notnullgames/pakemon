-- requires this installed: luarocks install luasql-sqlite3
local driver = require "luasql.sqlite3"

StateExploitDemo = require "plugins.exploitdb.state_exploite_demo"

local PluginExploitDemo = {}

-- this is the real root dir
local realdir = love.filesystem.getRealDirectory('plugins')

-- this is for the database
local env = assert (driver.sqlite3())
local con = assert (env:connect(realdir .. '/plugins/exploitdb/exploits.sqlite'))

function PluginExploitDemo:load()
	plugins.menu.main:addItem("Exploit Database", function() Gamestate.switch(StateExploitDemo) end, 2)
end

-- this is a helper for doing simpler database queries (using an iterator)
function PluginExploitDemo:query(sql_statement)
  local cursor = assert (con:execute (sql_statement))
  return function ()
    return cursor:fetch()
  end
end


return PluginExploitDemo